machine:
  timezone:
    UTC
  services:
    - docker
  php:
    version: 5.6.14

dependencies:
  cache_directories:
    - vendor
    - bin
  pre:
    - pecl install xdebug
    - cat ~/.phpenv/versions/$(phpenv version-name)/etc/conf.d/xdebug.ini | sed -e "s/;//" > xdebug.ini
    - mv xdebug.ini ~/.phpenv/versions/$(phpenv version-name)/etc/conf.d/xdebug.ini
  override:
    - composer install --prefer-source --no-interaction
    - docker run -d -p 8080:8080 rancher/server

test:
  override:
    - ant build
  post:
    - pip install --user codecov
    - codecov